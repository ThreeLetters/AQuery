/*
 Aquery: The world's best DOM wrapper

 Author: Andrews54757 & LegitSoulja
 License: MIT (https://github.com/ThreeLetters/AQuery/blob/master/LICENSE)
 Source: https://github.com/ThreeLetters/AQuery
 Build: v0.0.1
 Built on: 29/11/2017
*/

(function(l){function q(a,c,b,e){if(a.global)return!0}function K(a){a.global&&0===h.active++&&q(a,null,"ajaxStart")}function L(a,c){var b=c.context;if(!1===c.beforeSend.call(b,a,c)||!1===q(c,b,"ajaxBeforeSend",[a,c]))return!1;q(c,b,"ajaxSend",[a,c])}function C(a,c,b){var e=b.context;b.success.call(e,a,"success",c);q(b,e,"ajaxSuccess",[c,b,a]);w("success",c,b)}function z(a,c,b,e){var f=e.context;e.error.call(f,b,c,a);q(e,f,"ajaxError",[b,e,a]);w(c,b,e)}function w(a,c,b){var e=b.context;b.complete.call(e,
c,a);q(b,e,"ajaxComplete",[c,b]);b.global&&!--h.active&&q(b,null,"ajaxStop")}function t(){}function M(a){return a&&("text/html"==a?"html":"application/json"==a?"json":N.test(a)?"script":O.test(a)&&"xml")||"text"}function D(a){"object"===type(a.data)&&(a.data=P(a.data));!a.data||a.type&&"GET"!=a.type.toUpperCase()||(a.url=(a.url+"&"+a.data).replace(/[&?]{1,2}/,"?"))}function E(a,c,b,e){var f="array"===type(c),g;for(g in c){var m=c[g];e&&(g=b?e:e+"["+(f?"":g)+"]");!e&&f?a.add(m.name,m.value):(b?"array"===
type(m):"object"===type(m))?E(a,m,b,g):a.add(g,m)}}function P(a,c){var b=[];b.add=function(a,b){this.push(F(a)+"="+F(b))};E(b,a,c);return b.join("&").replace("%20","+")}function G(a){Array.prototype.slice.call(arguments,1).forEach(function(c){for(p in c)void 0!==c[p]&&(a[p]=c[p])});return a}function x(a){a.id||(a.id="aquery_id_"+Q++);A[a.id]||(A[a.id]=H(null,a,null));return A[a.id]}function H(a,c,b){var e={},f={bindings:e,parent:a,current:c,name:b,listeners:[]},g="object"===typeof c&&("object"===
typeof HTMLElement?c instanceof HTMLElement:c&&"object"===typeof c&&null!==c&&1===c.nodeType&&"string"===typeof c.nodeName);return new Proxy(c,{get:function(a,d){if("elementData"===d)return f;if("$"===d.charAt(0)){d=d.substr(1);if(g&&k[d])return k[d](f,!0,"get");e[d]||(e[d]={isRefrence:!0,owner:c,attached:[],name:d,update:function(a){var d=this;this.owner[this.name]=a;this.attached.forEach(function(b){b.current[d.name]=a})}});return e[d]}if(g&&k[d])return k[d](f,!1,"get");if(c[d])return"object"===
typeof c[d]?H(c,c[d],d):c[d]},set:function(a,d,b){"$"===d.charAt(0)&&(d=d.substr(1));if(g&&k[d])k[d](f,!0,"set",b);else b&&b.isRefrence?e[d]!==b&&(e[d]&&(a=e[d].attached.indexOf(f),e[d].attached[a]=e[d].attached[e[d].attached.length-1],e[d].attached[a].pop()),b.attached.push(f),c[d]=b.owner[b.name],e[d]=b):e[d]?e[d].update(b):c[d]=b},has:function(a,b){},deleteProperty:function(a,b){if("$"===b.charAt(0))if(b=b.substr(1),g&&k[b])k[b](f,!0,"delete");else{if(e[b]){if(e[b].owner===c)e[b].attached.forEach(function(a){a.bindings[b]=
null}),e[b].attached=null;else{var d=e[b].attached.indexOf(f);e[b].attached[d]=e[b].attached[e[b].attached.length-1];e[b].attached[d].pop()}e[b]=null}}else if(g&&k[b])k[b](f,!1,"delete")}})}function S(a,c){var b={nodes:a,wrappers:[],selector:c,selectorSplit:c.split(/[> ]/),listeners:[]};a.forEach(function(a,f){b.wrappers[f]=x(a)});return new Proxy(b,{get:function(c,f){if("length"===f)return a.length;var e=!1;"$"===f.charAt(0)&&(f=f.substr(1),e=!0);if("number"===typeof f&&b.nodes[f])return e?b.nodes[f]:
b.wrappers[f];if(y[f])return y[f](b,e);if(1===a.length)return b.nodes[0][(e?"$":"")+f]},set:function(a,b,c){}})}var k={},y={},u={},I={},A={},n=[],Q=0;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var c=a.length;0<=--c&&a.item(c)!==this;);
return-1<c});var T=function(a,c,b,e){var f=void 0,g=!1;if(b){f=c;var m=b;g=e}else m=c,g=b;try{var d=l.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.open(f?"POST":"GET",a+(g?"?"+Date.now():""));d.onreadystatechange=function(){4==d.readyState&&(200===d.status?m(void 0,d,d.responseText):m(!0,d,!1))};if(f){d.setRequestHeader("Content-type","application/x-www-form-urlencoded");a=[];for(var r in f)a.push(encodeURIComponent(r)+"="+encodeURIComponent(f[r]));f=a.join("&")}d.send(f)}catch(R){m(R)}},
U=0,v=l.document,p,B,N=/^(?:text|application)\/javascript/i,O=/^(?:text|application)\/xml/i,V=/^\s*$/,h=function(a,c){if(c)return T.apply(null,arguments);var b=G({},a||{});for(p in h.settings)void 0===b[p]&&(b[p]=h.settings[p]);K(b);b.crossDomain||(b.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(b.url)&&RegExp.$2!=l.location.host);var e=b.dataType,f=/=\?/.test(b.url);if("jsonp"==e||f)return f||(b.url=(b.url+"&callback=?").replace(/[&?]{1,2}/,"?")),h.JSONP(b);b.url||(b.url=l.location.toString());D(b);
f=b.accepts[e];var g={},m=/^([\w-]+:)\/\//.test(b.url)?RegExp.$1:l.location.protocol,d=h.settings.xhr(),r;b.crossDomain||(g["X-Requested-With"]="XMLHttpRequest");f&&(g.Accept=f,-1<f.indexOf(",")&&(f=f.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(f));if(b.contentType||b.data&&"GET"!=b.type.toUpperCase())g["Content-Type"]=b.contentType||"application/x-www-form-urlencoded";b.headers=G(g,b.headers||{});d.onreadystatechange=function(){if(4==d.readyState){clearTimeout(r);var a=!1;if(200<=d.status&&
300>d.status||304==d.status||0==d.status&&"file:"==m){e=e||M(d.getResponseHeader("content-type"));var f=d.responseText;try{"script"==e?(0,eval)(f):"xml"==e?f=d.responseXML:"json"==e&&(f=V.test(f)?null:JSON.parse(f))}catch(W){a=W}a?z(a,"parsererror",d,b):C(f,d,b)}else z(null,"error",d,b)}};d.open(b.type,b.url,"async"in b?b.async:!0);for(B in b.headers)d.setRequestHeader(B,b.headers[B]);if(!1===L(d,b))return d.abort(),!1;0<b.timeout&&(r=setTimeout(function(){d.onreadystatechange=t;d.abort();z(null,
"timeout",d,b)},b.timeout));d.send(b.data?b.data:null);return d};h.active=0;h.JSONP=function(a){if(!("type"in a))return h(a);var c="jsonp"+ ++U,b=v.createElement("script"),e={abort:function(){c in l&&(l[c]=t);w("abort",e,a)}},f,g=v.getElementsByTagName("head")[0]||v.documentElement;a.error&&(b.onerror=function(){e.abort();a.error()});l[c]=function(b){clearTimeout(f);delete l[c];C(b,e,a)};D(a);b.src=a.url.replace(/=\?/,"="+c);g.insertBefore(b,g.firstChild);0<a.timeout&&(f=setTimeout(function(){e.abort();
w("timeout",e,a)},a.timeout));return e};h.settings={type:"GET",beforeSend:t,success:t,error:t,complete:t,context:null,global:!0,xhr:function(){return new l.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0};h.get=function(a,c){return h({url:a,success:c})};h.post=function(a,c,b,e){"function"===type(c)&&(e=e||b,b=c,c=null);return h({type:"POST",url:a,data:c,success:b,
dataType:e})};h.getJSON=function(a,c){return h({url:a,success:c,dataType:"json"})};var F=encodeURIComponent;u.ajax=function(){return h};k.append=k.appendChild=function(a,c){return function(b){b.elementData||(b=x(b));var c=b.elementData;n.forEach(function(a){c.current.matches(a.selector)&&-1===c.listeners.indexOf(a)&&(c.current.addEventListener(a.type,a.listener,a.options),c.listeners.push(a))});a.current.appendChild(c.current)}};u.append=u.appendChild=function(){return function(a){a.elementData||
(a=x(a));var c=a.elementData;n.forEach(function(a){c.current.matches(a.selector)&&-1===c.listeners.indexOf(a)&&(c.current.addEventListener(a.type,a.listener,a.options),c.listeners.push(a))});v.body.appendChild(c.current)}};k.clone=function(a,c){return function(b){var c=a.current.cloneNode(!0),f=J(c);!1!==b&&a.listeners.forEach(function(a){f.elementData.listeners.push(a);f.elementData.current.addEventListener(a.type,a.listener,a.options)});return f}};k.on=k.addEventListener=function(a,c,b){if("delete"===
b)a.listeners.forEach(function(b){a.current.removeEventListener(b.type,b.listener)}),a.listeners=[];else return new Proxy(function(b,c,g){c._listenerData=c._listenerData||{type:b,listener:c,options:g};-1===a.listeners.indexOf(c._listenerData)&&(a.current.addEventListener(b,c,g),a.listeners.push(c._listenerData))},{get:function(b,c){if("length"===c)return a.listeners.length;if("number"===typeof c)return a.listeners[c].listener;var f=[];a.listeners.forEach(function(a){a.type===c&&f.push(a.listener)});
return new Proxy(f,{deleteProperty:function(b,c){if("number"===typeof c){var d=f[c];if(d){f.splice(c,1);var e=a.listeners.indexOf(d);-1!==d&&a.listeners.splice(e,1);a.current.removeEventListener(d.type,d.listener)}}}})},deleteProperty:function(b,c){if("number"===typeof c){var f=a.listeners[c];f&&(a.listeners.splice(c,1),a.current.removeEventListener(f.type,f.listener))}else a.listeners=a.listeners.filter(function(b){return b.type===c?(a.current.removeEventListener(b.type,b.listener),!1):!0})}})};
y.on=y.addEventListener=function(a,c,b){if("delete"===b)a.listeners.forEach(function(b){a.wrappers.forEach(function(a){a=a.elementData;var c=a.listeners.indexOf(b);-1!==c&&(a.listeners.splice(c,1),a.current.removeEventListener(b.type,b.listener))})}),a.listeners=[];else return new Proxy(function(b,f,g){var e=f._listenerData=f._listenerData||{selector:a.selector,type:b,listener:f,options:g};-1===a.listeners.indexOf(e)&&a.listeners.push(e);a.nodes.forEach(function(c,r){var d=a.wrappers[r].elementData;
-1===d.listeners.indexOf(e)&&(c.addEventListener(b,f,g),d.listeners.push(e))});c&&!e.isRefrenceEvent&&(n.push(e),e.isRefrenceEvent=!0)},{get:function(b,c){if("length"===c)return a.listeners.length;if("number"===typeof c)return a.listeners[c].listener;var f=[];a.listeners.forEach(function(a){a.type===c&&f.push(a.listener)});return new Proxy(f,{deleteProperty:function(b,c){if("number"===typeof c){var d=f[c];if(d){f.splice(c,1);var e=a.listeners.indexOf(d);-1!==d&&a.listeners.splice(e,1);d.isRefrenceEvent&&
(e=n.indexOf(d),n.splice(e,1),d.isRefrenceEvent=!1);a.wrappers.forEach(function(a){a=a.elementData;var b=a.listeners.indexOf(d);-1!==b&&(a.current.removeEventListener(d.type,d.listener),a.listeners.splice(b,1))})}}}})},deleteProperty:function(b,c){if("number"===typeof c){var e=a.listeners[c];if(e){a.listeners.splice(c,1);if(e.isRefrenceEvent){var f=n.indexOf(e);n.splice(f,1);e.isRefrenceEvent=!1}a.wrappers.forEach(function(a){a=a.elementData;var b=a.listeners.indexOf(e);-1!==b&&(a.current.removeEventListener(e.type,
e.listener),a.listeners.splice(b,1))})}}else a.listeners=a.listeners.filter(function(b){if(b.type===c){if(b.isRefrenceEvent){var d=n.indexOf(b);n.splice(d,1);b.isRefrenceEvent=!1}elementData.current.removeEventListener(b.type,b.listener);a.wrappers.forEach(function(a){a=a.elementData;var c=a.listeners.indexOf(b);-1!==c&&(a.current.removeEventListener(b.type,b.listener),a.listeners.splice(c,1))});return!1}return!0})}})};var J=new Proxy(function(a){if(a){if("string"===typeof a){var c=Array.from(v.querySelectorAll(a));
return S(c,a)}if("object"===typeof a)return x(a)}},{get:function(a,c){if(u[c])return u[c](c);if(I[c])return I[c]},set:function(a,c,b){}});l.AQuery=J;l.$||(l.$=l.AQuery)})(window);
